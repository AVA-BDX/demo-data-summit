version: "2.0"

rules:
- rule: start note_asking_form and store times for both user question and bot answer
  steps:
  - intent: faq
  - action: action_get_user_curent_intent
  - action: user_note_to_none
  - action: action_user_last_message
  - action: utter_faq
  - action: action_bot_last_message
  - action: action_bot_utterances_list
  - action: note_asking_form
  - active_loop: note_asking_form

- rule: go back to another faq when the user ask so
  condition:
  - active_loop: note_asking_form
  steps:
  - intent: faq
  - action: action_get_user_curent_intent
  - action: user_note_to_none
  - action: action_user_last_message
  - action: utter_faq
  - action: action_bot_last_message
  - action: action_bot_utterances_list
  - action: note_asking_form
  - active_loop: note_asking_form

- rule: submit the note_asking_form
  condition:
      - active_loop: note_asking_form
  steps:
    - action: note_asking_form
    - active_loop: null
    - action: action_record_the_user_note

- rule: The chatbot says it does not understand when it doesn't understand
  steps:
  - intent: nlu_fallback
  - action: utter_dont_understand

# - rule: bot verify identity
#   conversation_start: false
#   steps:
#   - action: action_session_start
#   - action: utter_restart